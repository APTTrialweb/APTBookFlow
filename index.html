<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>APT BookFlow</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Inter', sans-serif;
    margin: 0;
    background: linear-gradient(180deg, #071428 0%, #0f172a 100%);
    color: #f1f5f9;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
  }
  .container {
    background: rgba(255,255,255,0.03);
    backdrop-filter: blur(8px);
    padding: 24px;
    border-radius: 16px;
    width: 100%;
    max-width: 400px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.4);
  }
  h1, h2 {
    text-align: center;
    margin-bottom: 16px;
  }
  input, button {
    width: 100%;
    padding: 12px;
    margin: 8px 0;
    border-radius: 10px;
    border: none;
    font-size: 1rem;
  }
  input {
    background: rgba(255,255,255,0.05);
    color: #f1f5f9;
  }
  input::placeholder {
    color: #94a3b8;
  }
  button {
    background: linear-gradient(90deg, #06b6d4, #3b82f6);
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.2s;
  }
  button:hover {
    transform: scale(1.02);
  }
  .profile {
    text-align: center;
  }
  .profile img {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    margin-bottom: 10px;
    border: 3px solid #06b6d4;
  }
  .hidden {
    display: none;
  }
  #qr-reader {
    width: 100%;
    margin-top: 15px;
    border-radius: 12px;
    overflow: hidden;
  }
  .success {
    color: #10b981;
    font-weight: bold;
    text-align: center;
    margin-top: 10px;
  }
</style>
</head>
<body>
<div class="container">

  <!-- Login Screen -->
  <div id="login-screen">
    <h1>Coordinator Login</h1>
    <input type="text" id="login-id" placeholder="Coordinator ID">
    <input type="password" id="login-pass" placeholder="Password">
    <button id="login-btn">Login</button>
    <p id="login-error" style="color:#ef4444;display:none;">Invalid ID or password</p>
  </div>

  <!-- Profile + Scan Screen -->
  <div id="profile-screen" class="hidden">
    <div class="profile">
      <img id="profile-photo" src="" alt="Profile Photo">
      <h2 id="profile-name"></h2>
    </div>
    <button id="start-scan-btn">ðŸ“· Scan QR Code</button>
    <div id="qr-reader" class="hidden"></div>
    <div id="remaining-section" class="hidden">
      <input type="number" id="remaining-input" placeholder="Enter Remaining Books">
      <button id="submit-btn">Submit</button>
    </div>
    <p id="success-msg" class="success hidden">âœ… Data saved successfully!</p>
  </div>

</div>

<script src="https://unpkg.com/html5-qrcode/minified/html5-qrcode.min.js"></script>
<script>
  const loginScreen = document.getElementById('login-screen');
  const profileScreen = document.getElementById('profile-screen');

  const profileName = document.getElementById('profile-name');
  const profilePhoto = document.getElementById('profile-photo');
  const startScanBtn = document.getElementById('start-scan-btn');
  const qrReader = document.getElementById('qr-reader');
  const remainingSection = document.getElementById('remaining-section');
  const remainingInput = document.getElementById('remaining-input');
  const submitBtn = document.getElementById('submit-btn');
  const successMsg = document.getElementById('success-msg');

  let scannedCode = "";
  let coordinatorId = "";

  // Fake login for now (replace with Apps Script API call)
  document.getElementById('login-btn').addEventListener('click', () => {
    const id = document.getElementById('login-id').value.trim();
    const pass = document.getElementById('login-pass').value.trim();
    if(id && pass){
      coordinatorId = id;
      loginScreen.classList.add('hidden');
      profileScreen.classList.remove('hidden');
      profileName.textContent = `Coordinator ${id}`;
      profilePhoto.src = 'https://via.placeholder.com/100';
    } else {
      document.getElementById('login-error').style.display = 'block';
    }
  });

  // Start QR scan
  startScanBtn.addEventListener('click', () => {
    qrReader.classList.remove('hidden');
    const html5QrCode = new Html5Qrcode("qr-reader");
    html5QrCode.start(
      { facingMode: "environment" },
      { fps: 10, qrbox: 250 },
      qrCodeMessage => {
        scannedCode = qrCodeMessage;
        html5QrCode.stop();
        qrReader.classList.add('hidden');
        remainingSection.classList.remove('hidden');
      },
      () => {}
    );
  });

  // Submit data
  submitBtn.addEventListener('click', () => {
    const remaining = remainingInput.value.trim();
    if(!remaining){
      alert('Please enter remaining books');
      return;
    }
    successMsg.classList.remove('hidden');
    remainingSection.classList.add('hidden');
  });
</script>
</body>
</html>
